{% style %}
  #{{ section.id }}-featured-collection .featured-collection-wrapper{
    padding-top: {{section.settings.mobile_padding}}px;
    padding-bottom: {{section.settings.mobile_padding}}px;
  }
  section#{{ section.id }}-featured-collection{
    position:relative;
  }

  section#{{ section.id }}-featured-collection .featured-collection-wrapper{
    width:100%;
  }

  section#{{ section.id }}-featured-collection featured-slider{
    display:block;
    width:100%;
  }

  .fc-slide {
    box-sizing:border-box;
  }

  .featured-collection-slider-bar{
    position:relative;
  }

  [data-role="thumb-wrapper"]{
    height:4px;
    border-radius:4px;
    position:relative;
    overflow:hidden;
  }

  [data-role="thumb"]{
    position:absolute;
    top:0;
    left:0;
    height:100%;
    border-radius:4px;
    transition:left .2s linear, width .2s linear, transform .2s linear;
  }

  /* Fancybox overlay link cursor */
  .fc-fancybox-link { cursor: pointer; }

    /* âœ… allow smooth swipes inside slider area */
  section#{{ section.id }}-featured-collection .keen-slider {
    touch-action: pan-y; /* vertical page scroll allowed, horizontal swipe slider handle karega */
  }


  @media(min-width:1200px){
    #{{ section.id }}-featured-collection .featured-collection-wrapper{
      padding-top: {{section.settings.desktop_padding}}px;
      padding-bottom: {{section.settings.desktop_padding}}px;
    }
  }
{% endstyle %}

{% if section.settings.enable_slider %}
  {% render 'vite-tag' with 'xs-featured-collection-slider.js' %}
{% endif %}

<section
  id="{{ section.id }}-featured-collection"
  data-id="featured-collection-v2"
  style="background-color: {{section.settings.section_bg}}; color:{{section.settings.section_text_color}};
  {% if section.settings.enable_mt_minus %}
      margin-top: -{{ section.settings.mt_minus }}px;
  {% endif %}
  "
>
  <div class="xl:xcl-w-[1152px] xl:xcl-mx-auto">
    <div class="featured-collection-wrapper xcl-relative xcl-z-50 xcl-pl-4 xcl-pr-0 xl:xcl-pl-0">
      {% render 'section-heading' %}

      <div class="featured-collection-content_wrapper">
        <div class="featured-collection-cards">
          {% if section.settings.enable_slider %}
            <featured-slider
              class="featured-slider-root xcl-relative"
              data-desktop-cards="{{ section.settings.desktop_cards }}"
              data-mobile-perview="{{ section.settings.mobile_perview }}"
              data-show-arrows="{{ section.settings.show_arrows | json }}"
              data-fancybox-group="{{ section.id }}-fc"
            >
              <div
                data-role="slider-wrapper"
                class="keen-slider xcl-flex-nowrap xcl-overflow-hidden xcl-flex xcl-w-full"
                data-keen-el
              >
                {% for block in section.blocks %}
                  <div
                    class="
                      xcl-px-3 xcl-pt-3 xcl-pb-4
                      fc-slide keen-slider__slide
                      xcl-flex-[0_0_calc(100%/1.2_-_0px)]
                      lg:xcl-flex-[0_0_calc(100%/3_-_0px)]
                      xcl-border-solid xcl-border-2 xcl-rounded-2xl
                    "
                    data-block-index="{{ forloop.index0 }}"
                    style="border-color: {{section.settings.card_border_color}}; background:{{section.settings.card_bg_color}}"
                  >
                    {% if block.type == 'image_text' %}
                      <div class="fc-item xcl-block xcl-rounded-md xcl-overflow-hidden">
                        <div class="fc-media xcl-relative xcl-rounded-2xl xcl-overflow-hidden">

                          {% if block.settings.image %}
                            <img
                              src="{{ block.settings.image | img_url: 'master' }}"
                              alt="{{ block.settings.title }}"
                              style="width:100%;height:auto;display:block;"
                              loading="lazy"
                              class="xcl-rounded-2xl"
                            >

                            {%- comment -%}
                              Fancybox trigger overlay for IMAGE
                            {%- endcomment -%}
                            <a
                              class="fc-fancybox-link xcl-absolute xcl-inset-0 xcl-z-10"
                              href="{{ block.settings.image | img_url: 'master' }}"
                              data-fancybox="{{ section.id }}-fc"
                              data-caption="{{ block.settings.title | escape }}"
                            ></a>
                          {% endif %}

                        </div>

                        <div class="fc-content xcl-pt-2">
                          {% if block.settings.title %}
                            <h3
                              class="xcl-text-[16px] xcl-text-[#01C5E3] xcl-font-semibold xl:xcl-text-[24px]"
                              style="color:{{ section.settings.heading_color }}"
                            >
                              {{ block.settings.title }}
                            </h3>
                          {% endif %}

                          {% if block.settings.paragraph %}
                            <div class="xcl-text-[12px] xcl-font-normal xcl-mt-2 xl:xcl-text-[16px]">
                              {{ block.settings.paragraph }}
                            </div>
                          {% endif %}

                          {% if block.settings.button_label != blank and block.settings.button_url != blank %}
                            <a
                              href="{{ block.settings.button_url }}"
                              class="xcl-flex xcl-justify-center xcl-items-center xcl-mt-4 xcl-px-4 xcl-py-2 xcl-rounded-full xcl-text-[12px] xl:xcl-text-[14px] xcl-font-semibold xcl-bg-[#01E3BD] xcl-text-[#233052]"
                            >
                              {{ block.settings.button_label }}
                            </a>
                          {% endif %}
                        </div>
                      </div>

                    {% elsif block.type == 'video' %}
                      <div class="fc-item fc-video xcl-block xcl-rounded-md xcl-overflow-hidden">
                        <div class="fc-media xcl-relative xcl-rounded-2xl xcl-overflow-hidden" style="padding-top:56.25%; background:#000;">

                          {%- comment -%}
                            Fancybox trigger overlay for VIDEO
                            data-type="html5video" is REQUIRED for mp4
                          {%- endcomment -%}
                          <a
                            class="fc-fancybox-link xcl-absolute xcl-inset-0 xcl-z-20"
                            href="{{ block.settings.video_url }}"
                            data-fancybox="{{ section.id }}-fc"
                            data-caption="{{ block.settings.title | escape }}"
                            data-type="html5video"
                            data-html5video-format="video/mp4"
                          ></a>

                          {% if block.settings.poster %}
                            <img
                              src="{{ block.settings.poster | img_url: 'master' }}"
                              alt="{{ block.settings.title }}"
                              style="position:absolute;inset:0;width:100%;height:100%;object-fit:cover;"
                              class="video-poster"
                            >
                          {% endif %}

                          <video
                            data-video-src="{{ block.settings.video_url }}"
                            preload="metadata"
                            controlsList="nodownload"
                            style="position:absolute;inset:0;width:100%;height:100%;object-fit:cover;display:block;"
                            playsinline
                          ></video>

                          <button
                            type="button"
                            class="fc-video-play xcl-absolute xcl-left-1/2 xcl-bg-transparent xcl-border-none xcl-outline-none xcl-top-1/2 xcl-transform -xcl-translate-x-1/2 -xcl-translate-y-1/2 xcl-z-30"
                            aria-label="Play video"
                          >
                            <svg
                              width="37"
                              height="47"
                              viewBox="0 0 37 47"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg"
                            >
                              <path d="M0 46.6667V0L36.6667 23.3333L0 46.6667Z" fill="#D9D9D9"/>
                            </svg>
                          </button>
                        </div>

                        {% if block.settings.title != blank or block.settings.button_label != blank %}
                          <div class="fc-content xcl-p-3">
                            {% if block.settings.title != blank %}
                              <h3 class="xcl-text-lg xcl-font-medium">{{ block.settings.title }}</h3>
                            {% endif %}

                            {% if block.settings.button_label != blank and block.settings.button_url != blank %}
                              <a
                                href="{{ block.settings.button_url }}"
                                class="xcl-inline-flex xcl-items-center xcl-justify-center xcl-mt-3 xcl-px-4 xcl-py-2 xcl-rounded-full xcl-text-[12px] xl:xcl-text-[14px] xcl-font-semibold xcl-bg-[#01C5E3] xcl-text-[#233052]"
                              >
                                {{ block.settings.button_label }}
                              </a>
                            {% endif %}
                          </div>
                        {% endif %}
                      </div>
                    {% endif %}
                  </div>
                {% endfor %}
              </div>

              {% if section.settings.show_arrows %}
                <button class="fc-arrow fc-arrow-left
                xcl-hidden
                xcl-absolute
                xcl-top-1/2
                xcl--translate-y-1/2
                xcl-z-30
                xcl-bg-transparent
                xcl-border-none
                xcl-cursor-pointer
                xl:xcl-flex
                xcl-items-center
                xcl-justify-center
                xcl-w-[40px]
                xcl-h-[40px]
                xl:xcl-left-[-55px]
                " data-role="arrow-prev" aria-label="Previous slide">
                  <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40" fill="none">
                    <path d="M13.6667 20L23.6667 30L26 27.6667L18.3333 20L26 12.3333L23.6667 10L13.6667 20Z" fill="white"/>
                  </svg>
                </button>

                <button class="fc-arrow fc-arrow-right
                xcl-hidden
                  xcl-absolute
                  xcl-top-1/2
                  xcl--translate-y-1/2
                  xcl-z-30
                  xcl-bg-transparent
                  xcl-border-none
                  xcl-cursor-pointer
                  xl:xcl-flex
                  xcl-items-center
                  xcl-justify-center
                  xcl-w-[40px]
                  xcl-h-[40px]
                  xl:xcl-right-[-55px]
                " data-role="arrow-next" aria-label="Next slide">
                  <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40" fill="none">
                    <path d="M26.3333 20L16.3333 30L14 27.6667L21.6667 20L14 12.3333L16.3333 10L26.3333 20Z" fill="white"/>
                  </svg>
                </button>
              {% endif %}

              {% if section.settings.slider_bar %}
                <div class="featured-collection-slider-bar xcl-max-w-[calc(100%_-_16px)] xcl-mx-auto xcl-mt-3 lg:xcl-mt-[26px]">
                  <div
                    data-role="thumb-wrapper"
                    style="background-color:{{ section.settings.thumb_bg }}"
                    class="xcl-w-full xcl-relative xcl-h-[4px] xcl-rounded-sm"
                  >
                    <div data-role="thumb" style="background-color:{{ section.settings.thumb_color }}"></div>
                  </div>
                </div>
              {% endif %}
            </featured-slider>
          {% else %}
            <div class="xcl-grid xcl-grid-cols-2 lg:xcl-grid-cols-4 xcl-gap-3">
              {% for block in section.blocks %}
                <div class="xcl-p-2">
                  {% if block.type == 'image_text' %}
                    <div class="xcl-block">
                      {% if block.settings.image -%}
                        <img
                          src="{{ block.settings.image | img_url: 'master' }}"
                          alt="{{ block.settings.title }}"
                          style="width:100%;height:auto;"
                        >
                      {%- endif %}
                      {% if block.settings.title %}
                        <h3>{{ block.settings.title }}</h3>
                      {% endif %}
                      {% if block.settings.paragraph %}
                        <p>{{ block.settings.paragraph }}</p>
                      {% endif %}
                      {% if block.settings.button_label != blank and block.settings.button_url != blank %}
                        <a
                          href="{{ block.settings.button_url }}"
                          class="xcl-inline-flex xcl-items-center xcl-justify-center xcl-mt-2 xcl-px-4 xcl-py-2 xcl-rounded-full xcl-text-[12px] xcl-font-semibold xcl-bg-[#01C5E3] xcl-text-[#233052]"
                        >
                          {{ block.settings.button_label }}
                        </a>
                      {% endif %}
                    </div>

                  {% elsif block.type == 'video' %}
                    <div>
                      {% if block.settings.poster -%}
                        <img
                          src="{{ block.settings.poster | img_url: 'master' }}"
                          alt="{{ block.settings.title }}"
                          style="width:100%;height:auto;"
                        >
                      {%- endif %}
                      {% if block.settings.title %}
                        <h3>{{ block.settings.title }}</h3>
                      {% endif %}
                      {% if block.settings.button_label != blank and block.settings.button_url != blank %}
                        <a
                          href="{{ block.settings.button_url }}"
                          class="xcl-inline-flex xcl-items-center xcl-justify-center xcl-mt-2 xcl-px-4 xcl-py-2 xcl-rounded-full xcl-text-[12px] xcl-font-semibold xcl-bg-[#01C5E3] xcl-text-[#233052]"
                        >
                          {{ block.settings.button_label }}
                        </a>
                      {% endif %}
                    </div>
                  {% endif %}
                </div>
              {% endfor %}
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Featured collection",
  "settings": [
    { "type": "range", "id": "mobile_padding", "label": "Mobile Padding Y axis", "min": 10, "max": 60, "step": 2, "default": 56 },
    { "type": "range", "id": "desktop_padding", "label": "Desktop Padding Y axis", "min": 0, "max": 90, "step": 1, "default": 88 },
    { "type": "color", "label": "section background color", "id": "section_bg", "default": "#1E1E1E" },
    { "type": "color", "label": "section text color", "id": "section_text_color", "default": "#ffffff" },
    { "type": "checkbox", "label": "Enable slider", "id": "enable_slider", "default": true },
    { "type": "range", "label": "Desktop cards to show (per view)", "id": "desktop_cards", "min": 1, "max": 4, "step": 1, "default": 3 },
    { "type": "color", "label": "Card Border color", "id": "card_border_color", "default": "#01C5E3" },
    { "type": "color", "label": "Card Bg color", "id": "card_bg_color", "default": "#000000" },
    { "type": "text", "label": "Mobile perView (decimal allowed, e.g. 1.2)", "id": "mobile_perview", "default": "1.2" },
    { "type": "checkbox", "label": "Show arrows", "id": "show_arrows", "default": true },
    { "type": "checkbox", "label": "Display slider thumb bar", "id": "slider_bar", "default": true },
    { "type": "color", "label": "Thumb slider background color", "id": "thumb_bg", "default": "#155059" },
    { "type": "color", "label": "Thumb color", "id": "thumb_color", "default": "#01C5E3" },
    { "type": "html", "label": "Section title", "id": "section_title", "default": "TradeEdge <span> Pro</span> Features" },
    { "type": "color", "label": "Heading color", "id": "heading_color", "default": "#000000" },
    { "type": "color", "label": "section title color", "id": "section_title_color", "default": "#000000" },
    { "type": "checkbox", "id": "enable_mt_minus", "label": "Enable Margin Top Minus", "default": false },
    { "type": "range", "id": "mt_minus", "label": "Margin Top Minus", "min": 0, "max": 250, "step": 10, "default": 250, "unit": "px" }
  ],
  "blocks": [
    {
      "type": "image_text",
      "name": "Image with text",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Image" },
        { "type": "text", "id": "title", "label": "Title" },
        { "type": "richtext", "id": "paragraph", "label": "Paragraph" },
        { "type": "text", "id": "button_label", "label": "Button label" },
        { "type": "url", "id": "button_url", "label": "Button URL" }
      ]
    },
    {
      "type": "video",
      "name": "Video (mp4)",
      "settings": [
        { "type": "text", "id": "video_url", "label": "MP4 URL" },
        { "type": "image_picker", "id": "poster", "label": "Poster / fallback image (optional)" },
        { "type": "text", "id": "title", "label": "Title" },
        { "type": "text", "id": "button_label", "label": "Button label" },
        { "type": "url", "id": "button_url", "label": "Button URL" }
      ]
    }
  ],
  "presets": [{ "name": "Featured Card (blocks)" }]
}
{% endschema %}
